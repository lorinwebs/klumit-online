# ✅ Checklist - תכנית נאמנות

## 📋 לפני PR

### Database
- [ ] הרצת migration ב-Supabase
- [ ] בדקת שכל הטבלאות נוצרו
- [ ] בדקת RLS policies
- [ ] בדקת indexes

### Environment
- [ ] `SHOPIFY_ADMIN_API_TOKEN` מוגדר
- [ ] בדקת שהטוקן עם הרשאה `write_discounts`
- [ ] Vercel Cron מוגדר (אופציונלי)

### Backend
- [ ] כל ה-API endpoints עובדים
- [ ] Webhook מעדכן נקודות
- [ ] יצירת קוד הנחה עובדת
- [ ] ביטול קוד עובד
- [ ] Cron job מנקה קודים

### Frontend
- [ ] UI ב-checkout עובד
- [ ] UI בחשבון עובד
- [ ] טעינת נקודות עובדת
- [ ] יצירת קוד עובדת
- [ ] החלת קוד עובדת

### Testing
- [ ] בדקת צבירת נקודות
- [ ] בדקת שימוש בנקודות
- [ ] בדקת ניקוי קודים
- [ ] בדקת edge cases

### Documentation
- [ ] `LOYALTY_PROGRAM_DESIGN.md` מעודכן
- [ ] `LOYALTY_PROGRAM_README.md` מעודכן
- [ ] קוד מעודכן עם הערות

## 🧪 בדיקות ידניות

### צבירת נקודות
1. [ ] ביצע רכישה
2. [ ] בדק שנקודות נצברו ב-DB
3. [ ] בדק שה-transaction נוצר
4. [ ] בדק שהנקודות מוצגות בחשבון

### שימוש בנקודות
1. [ ] נכנס ל-checkout
2. [ ] בחר להשתמש בנקודות
3. [ ] בדק שקוד נוצר
4. [ ] בדק שהקוד הוחל על cart
5. [ ] ביצע רכישה
6. [ ] בדק שנקודות התעדכנו
7. [ ] בדק שקוד עודכן ל-'used'

### ניקוי קודים
1. [ ] יצר קוד
2. [ ] חיכה 2+ שעות (או שינה תאריך תפוגה)
3. [ ] הרץ cleanup endpoint
4. [ ] בדק שהקוד עודכן ל-'expired'

### Edge Cases
1. [ ] משתמש לא מחובר - לא יכול להשתמש
2. [ ] אין נקודות - אופציה מוסתרת
3. [ ] יותר נקודות מסכום - הגבלה למקסימום
4. [ ] קוד פג תוקף - הודעת שגיאה
5. [ ] עזיבת checkout - קוד מתבטל

## 📝 PR Description Template

```markdown
## תכנית נאמנות

### מה נוסף
- תכנית נאמנות עם 10% צבירת נקודות
- שימוש בנקודות ב-checkout
- קודי הנחה ייחודיים, חד-פעמיים

### שינויים
- [ ] Database: טבלאות חדשות
- [ ] Backend: API endpoints חדשים
- [ ] Frontend: UI ב-checkout ו-account
- [ ] Webhook: עדכון נקודות

### בדיקות
- [ ] צבירת נקודות עובדת
- [ ] שימוש בנקודות עובד
- [ ] ניקוי קודים עובד

### תיעוד
- `LOYALTY_PROGRAM_DESIGN.md` - תכנון מלא
- `LOYALTY_PROGRAM_README.md` - מדריך התקנה
```
